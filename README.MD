# üèãÔ∏è‚Äç‚ôÇÔ∏è Gym Entry Backend

A Node.js, Express, and TypeScript-based backend application for managing a gym system. It supports authentication, role-based access, and CRUD operations for users, members, and memberships. Built with Prisma ORM and PostgreSQL.

## üîß Features

- ‚úÖ Authentication system with login/logout
- üîê Role-based access control (Admin & Authenticated User)
- üë• User management (CRUD + password update)
- üè∑Ô∏è Membership management (CRUD)
- üßç Member management with membership assignment and scan support
- üõ°Ô∏è Request validation with Zod
- üåê PostgreSQL integration via Prisma
- üì¶ Session handling with `express-session` and `connect-pg-simple`

---

### üîê Dummy Test User Credentials

After seeding the database, the following test users are created:

- **Admin User**

  - **Username:** `admin`
  - **Password:** `password`

- **Staff User**
  - **Username:** `staff`
  - **Password:** `password`

> üí° These credentials are for testing purposes only. Make sure to change them in production environments.

## üõ†Ô∏è Tech Stack

- **Runtime:** Node.js
- **Framework:** Express
- **Language:** TypeScript
- **ORM:** Prisma
- **DB:** PostgreSQL (Render hosted)
- **Validation:** Zod
- **Auth:** Session-based authentication
- **Security:** bcrypt for password hashing
- **Session Store:** connect-pg-simple
- **Dev Tools:** ESLint, nodemon, ts-node

---

## üöÄ Getting Started

### 1. Clone the repo

```bash
git clone https://github.com/your-username/gym-entry-backend.git
cd gym-entry-backend
```

### 2. Install dependencies

```bash
npm install

```

### 3. Set up environment variables

- Create a .env file in the root directory:

```bash
PORT=your_port
DATABASE_URL=your_postgresql_connection_string
SESSION_SECRET=your_secret_session_key

```

### 4. Run Prisma migrations

```bash
npx prisma generate
npx prisma migrate dev --name init

```

### 5. Run Prisma seed to populate database

```bash
npm run seed

```

### 6. Start the server

```bash
npm start

```

## üìÅ API Routes

### üõ°Ô∏è Auth Routes (`/api/auth`)

| Method | Endpoint  | Description            | Access        |
| ------ | --------- | ---------------------- | ------------- |
| GET    | `/`       | Get authenticated user | Authenticated |
| POST   | `/login`  | Log in user            | Public        |
| POST   | `/logout` | Log out user           | Authenticated |

---

### üë§ User Routes (`/api/users`) ‚Äì _Admin Only_

| Method | Endpoint                   | Description          | Access      |
| ------ | -------------------------- | -------------------- | ----------- |
| GET    | `/`                        | Get all users        | Admin       |
| GET    | `/:userId`                 | Get single user      | Admin       |
| POST   | `/`                        | Create user          | Admin       |
| PUT    | `/:userId`                 | Update user          | Admin       |
| PATCH  | `/:userId/update-password` | Update user password | Staff/Admin |
| PATCH  | `/:userId/reset-password`  | Reset user password  | Admin       |
| DELETE | `/:userId`                 | Delete user          | Admin       |

---

### üßç Member Routes (`/api/members`)

| Method | Endpoint                | Description              | Access        |
| ------ | ----------------------- | ------------------------ | ------------- |
| GET    | `/`                     | Get all members          | Authenticated |
| GET    | `/:memberId`            | Get single member        | Authenticated |
| GET    | `/scan/:uniqueId`       | Scan member by unique ID | Authenticated |
| POST   | `/`                     | Create member            | Authenticated |
| PUT    | `/:memberId`            | Update member            | Authenticated |
| PATCH  | `/:memberId/membership` | Extend membership        | Authenticated |
| DELETE | `/:memberId`            | Delete member            | Authenticated |

---

### üè∑Ô∏è Membership Routes (`/api/memberships`)

| Method | Endpoint         | Description           | Access        |
| ------ | ---------------- | --------------------- | ------------- |
| GET    | `/`              | Get all memberships   | Authenticated |
| GET    | `/:membershipId` | Get single membership | Authenticated |
| POST   | `/`              | Create membership     | Admin         |
| PUT    | `/:membershipId` | Update membership     | Admin         |
| DELETE | `/:membershipId` | Delete membership     | Admin         |
